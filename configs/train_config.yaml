# Training Configuration for 3D Tooth Segmentation

# Model Configuration
model:
  name: UNet3D
  n_channels: 1
  n_classes: 4  # Background, Enamel, Dentin, Pulpa
  base_channels: 32
  trilinear: false

# Data Configuration
data:
  train_root: "data/train"
  val_root: "data/val"
  test_internal_root: "data/test_internal"
  test_external_root: "data/test_external"
  
  # Preprocessing
  preprocessing:
    target_spacing: [0.1, 0.1, 0.1]  # mm
    target_size: [128, 128, 128]  # voxels
    normalize: true
    clip_range: [-1000, 3000]  # HU values
  
  # Augmentation
  augmentation:
    rotation_range: 15.0  # degrees
    flip_prob: 0.5
    noise_std: 0.05
    brightness_range: 0.2
    elastic_alpha: 10.0
    elastic_sigma: 4.0

# Training Configuration
training:
  batch_size: 2
  num_epochs: 100
  num_workers: 4
  
  # Optimizer
  optimizer:
    name: AdamW
    lr: 0.0001
    weight_decay: 0.0001
  
  # Scheduler
  scheduler:
    name: CosineAnnealingLR
    T_max: 100
    eta_min: 0.000001
  
  # Loss Function
  loss:
    type: combined
    dice_weight: 0.5
    ce_weight: 0.3
    focal_weight: 0.2
    class_weights: null  # [1.0, 2.0, 2.0, 3.0] for weighted loss

# Evaluation Configuration
evaluation:
  metrics:
    - dice
    - iou
    - hausdorff
    - volume_similarity
  save_predictions: true

# Active Learning Configuration
active_learning:
  enabled: false
  uncertainty_method: "entropy"  # entropy, mc_dropout, margin
  n_samples_per_iteration: 10
  selection_strategy: "uncertainty"  # uncertainty, random
  max_iterations: 5

# Class Names
class_names:
  - Background
  - Enamel
  - Dentin
  - Pulpa

# Output Directories
output:
  checkpoint_dir: "checkpoints"
  log_dir: "logs"
  results_dir: "results"

# Device Configuration
device: "cuda"  # cuda or cpu
